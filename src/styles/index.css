/**
 * UniClub â€” Optimized CSS
 * iOS 26 Liquid Glass Design System
 */

/* ===== CSS VARIABLES ===== */
:root {
  /* Spacing */
  --sp-2: 2px; --sp-4: 4px; --sp-6: 6px; --sp-8: 8px; --sp-10: 10px;
  --sp-12: 12px; --sp-16: 16px; --sp-20: 20px; --sp-24: 24px;
  --sp-32: 32px; --sp-40: 40px; --sp-48: 48px;
  
  /* Colors */
  --blue: #007AFF; --green: #30D158; --orange: #FF9F0A; --red: #FF453A;
  --purple: #BF5AF2; --indigo: #5E5CE6; --cyan: #64D2FF; --pink: #FF375F;
  
  /* Light theme */
  --bg-primary: #F2F2F7; --bg-secondary: #FFFFFF; --bg-tertiary: #E5E5EA;
  --glass-bg: rgba(255,255,255,.65); --glass-bg-thick: rgba(255,255,255,.85);
  --glass-bg-thin: rgba(255,255,255,.45); --glass-border: rgba(255,255,255,.5);
  --glass-border-subtle: rgba(255,255,255,.25); --glass-shadow: rgba(0,0,0,.08);
  --glass-highlight: rgba(255,255,255,.8);
  --text-primary: rgba(0,0,0,.85); --text-secondary: rgba(60,60,67,.85);
  --text-tertiary: rgba(60,60,67,.5);
  --fill-primary: rgba(120,120,128,.2); --fill-secondary: rgba(120,120,128,.12);
  --fill-tertiary: rgba(120,120,128,.08); --separator: rgba(60,60,67,.1);
  
  /* Glass variations */
  --glass-ultra-thin: rgba(255,255,255,.35); --glass-thin: rgba(255,255,255,.55);
  --glass-medium: rgba(255,255,255,.75);
  
  /* Gradients */
  --gradient-blue: linear-gradient(135deg, #007AFF, #5856D6);
  --gradient-purple: linear-gradient(135deg, #5856D6, #BF5AF2);
  --gradient-green: linear-gradient(135deg, #30D158, #00C7BE);
  --gradient-orange: linear-gradient(135deg, #FF9F0A, #FF375F);
  
  /* Shadows */
  --shadow-blue: 0 8px 32px rgba(0,122,255,.25);
  --shadow-card: 0 8px 32px var(--glass-shadow), inset 0 1px 0 var(--glass-highlight);
  
  /* Border radius */
  --radius-sm: 12px; --radius-md: 16px; --radius-lg: 22px;
  --radius-xl: 28px; --radius-2xl: 36px; --radius-full: 9999px;
  
  /* Typography */
  --font: -apple-system, BlinkMacSystemFont, 'SF Pro Display', system-ui, sans-serif;
  --text-xs: 11px; --text-sm: 13px; --text-base: 15px; --text-md: 17px;
  --text-lg: 20px; --text-xl: 22px; --text-2xl: 28px; --text-3xl: 34px;
  
  /* Layout */
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --tab-bar-height: 90px; --sidebar-width: 280px;
  
  /* Animation */
  --ease-liquid: cubic-bezier(.4,0,.2,1);
  --ease-bounce: cubic-bezier(.34,1.56,.64,1);
  --spring-easing: cubic-bezier(.34,1.56,.64,1);
  --duration-fast: .15s; --duration-normal: .25s; --duration-slow: .4s;
}

/* Dark theme */
@media (prefers-color-scheme: dark) {
  :root {
    --bg-primary: #000; --bg-secondary: #1C1C1E; --bg-tertiary: #2C2C2E;
    --glass-bg: rgba(44,44,46,.65); --glass-bg-thick: rgba(44,44,46,.85);
    --glass-bg-thin: rgba(44,44,46,.45); --glass-border: rgba(255,255,255,.15);
    --glass-border-subtle: rgba(255,255,255,.08); --glass-shadow: rgba(0,0,0,.35);
    --glass-highlight: rgba(255,255,255,.12);
    --text-primary: rgba(255,255,255,.92); --text-secondary: rgba(235,235,245,.7);
    --text-tertiary: rgba(235,235,245,.4);
    --fill-primary: rgba(120,120,128,.36); --fill-secondary: rgba(120,120,128,.28);
    --fill-tertiary: rgba(120,120,128,.2); --separator: rgba(84,84,88,.6);
    --glass-ultra-thin: rgba(44,44,46,.35); --glass-thin: rgba(44,44,46,.55);
    --glass-medium: rgba(44,44,46,.75);
  }
}

/* Forced light/dark theme */
:root[data-theme="light"] {
  --bg-primary: #F2F2F7; --bg-secondary: #FFF; --bg-tertiary: #E5E5EA;
  --glass-bg: rgba(255,255,255,.65); --glass-bg-thick: rgba(255,255,255,.85);
  --glass-bg-thin: rgba(255,255,255,.45); --glass-border: rgba(255,255,255,.5);
  --glass-border-subtle: rgba(255,255,255,.25); --glass-shadow: rgba(0,0,0,.08);
  --glass-highlight: rgba(255,255,255,.8);
  --text-primary: rgba(0,0,0,.85); --text-secondary: rgba(60,60,67,.85);
  --text-tertiary: rgba(60,60,67,.5);
  --fill-primary: rgba(120,120,128,.2); --fill-secondary: rgba(120,120,128,.12);
  --fill-tertiary: rgba(120,120,128,.08); --separator: rgba(60,60,67,.1);
}

:root[data-theme="dark"] {
  --bg-primary: #000; --bg-secondary: #1C1C1E; --bg-tertiary: #2C2C2E;
  --glass-bg: rgba(44,44,46,.65); --glass-bg-thick: rgba(44,44,46,.85);
  --glass-bg-thin: rgba(44,44,46,.45); --glass-border: rgba(255,255,255,.15);
  --glass-border-subtle: rgba(255,255,255,.08); --glass-shadow: rgba(0,0,0,.35);
  --glass-highlight: rgba(255,255,255,.12);
  --text-primary: rgba(255,255,255,.92); --text-secondary: rgba(235,235,245,.7);
  --text-tertiary: rgba(235,235,245,.4);
  --fill-primary: rgba(120,120,128,.36); --fill-secondary: rgba(120,120,128,.28);
  --fill-tertiary: rgba(120,120,128,.2); --separator: rgba(84,84,88,.6);
}

/* ===== RESET & BASE ===== */
*,*::before,*::after { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
html { font-family: var(--font); -webkit-font-smoothing: antialiased; overflow-x: hidden; }
body { background: var(--bg-primary); color: var(--text-primary); min-height: 100dvh; line-height: 1.4; overflow-x: hidden; width: 100%; max-width: 100vw; }
#root, .app-layout, .main-content, .page-content { overflow-x: hidden; width: 100%; max-width: 100%; }
.app-layout { display: flex; min-height: 100dvh; }

/* ===== GLASS MIXIN (reusable) ===== */
.glass, .card, .list-section, .stat-card, .sidebar-inner, .tab-bar, .modal, .confirm-modal, .notification, .ios-faculty-card {
  background: var(--glass-bg);
  backdrop-filter: blur(40px) saturate(180%);
  -webkit-backdrop-filter: blur(40px) saturate(180%);
  border: 1px solid var(--glass-border);
  box-shadow: var(--shadow-card);
}

.glass-thick, .sidebar-inner, .tab-bar, .modal, .confirm-modal, .notification {
  background: var(--glass-bg-thick);
  backdrop-filter: blur(60px) saturate(200%);
  -webkit-backdrop-filter: blur(60px) saturate(200%);
}

/* ===== SIDEBAR ===== */
.sidebar { width: var(--sidebar-width); height: 100dvh; position: fixed; left: 0; top: 0; padding: var(--sp-16); z-index: 100; }
.sidebar-inner { height: 100%; display: flex; flex-direction: column; border-radius: var(--radius-xl); overflow: hidden; }
.sidebar-header { padding: var(--sp-24); border-bottom: 1px solid var(--separator); }
.sidebar-logo { display: flex; align-items: center; gap: var(--sp-12); }
.sidebar-logo-icon { width: 48px; height: 48px; background: var(--gradient-blue); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; font-size: 24px; flex-shrink: 0; box-shadow: var(--shadow-blue); }
.sidebar-logo-text { font-size: var(--text-xl); font-weight: 700; letter-spacing: -.02em; }
.sidebar-nav { flex: 1; padding: var(--sp-12); overflow-y: auto; }
.sidebar-footer { padding: var(--sp-12); border-top: 1px solid var(--separator); }

.sidebar-nav-item { display: flex; align-items: center; gap: var(--sp-12); padding: var(--sp-12) var(--sp-16); border-radius: var(--radius-md); color: var(--text-secondary); cursor: pointer; transition: all var(--duration-fast) var(--ease-liquid); margin-bottom: var(--sp-4); }
.sidebar-nav-item:hover { background: var(--fill-tertiary); color: var(--text-primary); }
.sidebar-nav-item.active { background: var(--gradient-blue); color: #fff; box-shadow: var(--shadow-blue); }
.nav-icon { font-size: 20px; width: 24px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
.nav-label { font-size: var(--text-md); font-weight: 500; }

/* ===== MAIN CONTENT ===== */
.main-content { flex: 1; margin-left: var(--sidebar-width); min-height: 100dvh; padding: var(--sp-24); padding-bottom: var(--sp-48); width: calc(100% - var(--sidebar-width)); }

@media (max-width: 1024px) {
  .sidebar { display: none; }
  .main-content { margin-left: 0; padding: var(--sp-16); padding-bottom: calc(var(--tab-bar-height) + var(--safe-bottom) + var(--sp-24)); width: 100%; max-width: 100%; }
}

/* ===== TAB BAR ===== */
.tab-bar { position: fixed; bottom: var(--sp-12); left: var(--sp-12); right: var(--sp-12); display: flex; align-items: center; justify-content: space-around; gap: var(--sp-2); padding: var(--sp-6) var(--sp-8); border-radius: var(--radius-xl); z-index: 1000; margin-bottom: var(--safe-bottom); }
.tab-bar-item { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: var(--sp-6) var(--sp-8); border-radius: var(--radius-md); cursor: pointer; transition: all var(--duration-fast) var(--ease-liquid); flex: 1; max-width: 72px; background: transparent; border: none; color: var(--text-tertiary); }
.tab-bar-item:active { transform: scale(.9); }
.tab-bar-item.active { color: #fff; background: var(--gradient-blue); box-shadow: 0 4px 12px rgba(0,122,255,.35); }
.tab-bar-icon { font-size: 22px; height: 24px; display: flex; align-items: center; justify-content: center; }
.tab-bar-label { font-size: 10px; font-weight: 600; margin-top: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%; }

@media (min-width: 1025px) { .tab-bar { display: none; } }

/* ===== MOBILE HEADER ===== */
.mobile-header { position: sticky; top: 0; z-index: 100; padding: calc(var(--safe-top) + var(--sp-12)) var(--sp-20) var(--sp-16); background: var(--glass-bg); backdrop-filter: blur(40px) saturate(180%); -webkit-backdrop-filter: blur(40px) saturate(180%); border-bottom: 1px solid var(--separator); margin: calc(-1 * var(--sp-16)); margin-bottom: var(--sp-20); width: calc(100% + var(--sp-32)); overflow: hidden; }
.mobile-header-content { display: flex; align-items: flex-end; justify-content: space-between; gap: var(--sp-16); min-height: 44px; }
.mobile-header-left { display: flex; align-items: center; gap: var(--sp-12); min-width: 0; flex: 1; }
.mobile-header-title { font-size: var(--text-3xl); font-weight: 700; letter-spacing: -.025em; line-height: 1.1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.mobile-header-subtitle { font-size: var(--text-base); color: var(--text-tertiary); margin-top: var(--sp-4); }
.mobile-header-actions { display: flex; gap: var(--sp-8); flex-shrink: 0; }
.mobile-header-search { margin-top: var(--sp-12); }

@media (min-width: 1025px) { .mobile-header { display: none; } }

/* ===== PAGE HEADER (Desktop) ===== */
.page-header { margin-bottom: var(--sp-24); }
.page-header h1 { font-size: 40px; font-weight: 700; letter-spacing: -.025em; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.page-header-content { display: flex; align-items: center; justify-content: space-between; gap: var(--sp-16); }
.page-header-subtitle { font-size: var(--text-base); color: var(--text-secondary); margin-top: var(--sp-4); }
.page-header-search { margin-top: var(--sp-16); max-width: 320px; }

@media (max-width: 1024px) { .page-header { display: none; } }

/* ===== CARDS ===== */
.card { border-radius: var(--radius-lg); padding: var(--sp-16); transition: transform var(--duration-normal) var(--ease-liquid), box-shadow var(--duration-normal) var(--ease-liquid); overflow: hidden; width: 100%; }
.card:hover { transform: translateY(-4px) scale(1.01); box-shadow: 0 16px 48px var(--glass-shadow), inset 0 1px 0 var(--glass-highlight); }
.card-pressable { cursor: pointer; }
.card-pressable:active { transform: scale(.98); }
.card-past { opacity: .6; }
.card-header { display: flex; gap: var(--sp-12); align-items: flex-start; }
.card-icon { width: 52px; height: 52px; border-radius: var(--radius-md); background: var(--fill-secondary); display: flex; align-items: center; justify-content: center; font-size: 26px; flex-shrink: 0; }
.card-icon.subscribed { background: linear-gradient(145deg, var(--green), #25a244); box-shadow: 0 4px 12px rgba(48,209,88,.3); }
.card-info { flex: 1; min-width: 0; overflow: hidden; }
.card-title { font-size: var(--text-md); font-weight: 600; line-height: 1.3; display: flex; align-items: center; gap: var(--sp-8); flex-wrap: wrap; }
.card-description { font-size: var(--text-base); color: var(--text-secondary); line-height: 1.45; margin-top: var(--sp-4); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; word-break: break-word; }
.card-meta { display: flex; flex-wrap: wrap; gap: var(--sp-12); margin-top: var(--sp-8); font-size: var(--text-sm); color: var(--text-tertiary); }
.card-meta-item { display: flex; align-items: center; gap: var(--sp-4); }
.card-footer { display: flex; gap: var(--sp-8); margin-top: var(--sp-16); padding-top: var(--sp-16); border-top: 1px solid var(--separator); flex-wrap: wrap; }
.cards-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: var(--sp-16); width: 100%; }

@media (max-width: 480px) { .cards-grid { grid-template-columns: 1fr; gap: var(--sp-12); } }

/* ===== BUTTONS ===== */
.btn { display: inline-flex; align-items: center; justify-content: center; gap: var(--sp-8); height: 48px; padding: 0 var(--sp-24); font-size: var(--text-md); font-weight: 600; font-family: var(--font); border-radius: var(--radius-md); border: none; cursor: pointer; transition: all var(--duration-fast) var(--ease-liquid); white-space: nowrap; flex-shrink: 0; }
.btn:active { transform: scale(.95); }
.btn:disabled { opacity: .5; pointer-events: none; }
.btn-primary { background: var(--gradient-blue); color: #fff; box-shadow: 0 4px 16px rgba(0,122,255,.35); }
.btn-primary:hover { box-shadow: 0 6px 24px rgba(0,122,255,.45); }
.btn-secondary { background: var(--glass-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid var(--glass-border); color: var(--blue); }
.btn-danger { background: linear-gradient(145deg, var(--red), #d62828); color: #fff; box-shadow: 0 4px 16px rgba(255,69,58,.35); }
.btn-glass { background: var(--glass-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid var(--glass-border); color: var(--text-primary); }
.btn-icon { width: 48px; height: 48px; padding: 0; border-radius: var(--radius-full); }
.btn-small { height: 40px; padding: 0 var(--sp-16); font-size: var(--text-base); border-radius: var(--radius-sm); }
.btn-full { width: 100%; }

/* ===== INPUTS ===== */
.input, .form-select { width: 100%; height: 48px; padding: 0 var(--sp-16); font-size: var(--text-md); font-family: var(--font); color: var(--text-primary); background: var(--glass-bg-thin); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 2px solid transparent; border-radius: var(--radius-md); outline: none; transition: all var(--duration-fast) var(--ease-liquid); max-width: 100%; }
.input:focus, .form-select:focus { background: var(--glass-bg); border-color: var(--blue); box-shadow: 0 0 0 4px rgba(0,122,255,.15); }
.input::placeholder { color: var(--text-tertiary); }
.textarea { height: auto; min-height: 120px; padding: var(--sp-12) var(--sp-16); resize: vertical; line-height: 1.5; }
.form-field { margin-bottom: var(--sp-16); }
.form-label { display: block; font-size: var(--text-base); font-weight: 500; color: var(--text-secondary); margin-bottom: var(--sp-8); }
.form-error { font-size: var(--text-sm); color: var(--red); margin-top: var(--sp-4); }
.form-select { padding: 0 var(--sp-40) 0 var(--sp-16); appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12'%3E%3Cpath fill='%238E8E93' d='M6 8L1 3h10z'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 16px center; cursor: pointer; }
.form-row { display: grid; grid-template-columns: 1fr 1fr; gap: var(--sp-16); }

/* Search Input */
.search-input-wrapper { position: relative; display: flex; align-items: center; gap: var(--sp-8); background: var(--glass-bg-thin); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border-radius: var(--radius-md); padding: 0 var(--sp-12); height: 44px; border: 1px solid var(--glass-border-subtle); width: 100%; }
.search-input-wrapper svg { flex-shrink: 0; }
.search-input { flex: 1; border: none; background: transparent; font-size: var(--text-md); font-family: var(--font); color: var(--text-primary); outline: none; height: 100%; min-width: 0; }
.search-input::placeholder { color: var(--text-tertiary); }
.input-with-icon { position: relative; display: flex; align-items: center; }
.input-with-icon svg { position: absolute; left: 16px; pointer-events: none; z-index: 1; }
.input.input-icon { padding-left: 48px; }

/* ===== STATS ===== */
.stats-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--sp-12); margin-bottom: var(--sp-24); }
@media (min-width: 768px) { .stats-grid { grid-template-columns: repeat(4, 1fr); gap: var(--sp-16); } }

.stat-card { border-radius: var(--radius-lg); padding: var(--sp-16); text-align: center; overflow: hidden; }
.stat-icon { width: 52px; height: 52px; margin: 0 auto var(--sp-12); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; font-size: 26px; }
.stat-icon.blue { background: var(--gradient-blue); box-shadow: var(--shadow-blue); }
.stat-icon.green { background: var(--gradient-green); box-shadow: 0 4px 12px rgba(48,209,88,.3); }
.stat-icon.orange { background: var(--gradient-orange); box-shadow: 0 4px 12px rgba(255,159,10,.3); }
.stat-icon.purple { background: var(--gradient-purple); box-shadow: 0 4px 12px rgba(191,90,242,.3); }
.stat-value { font-size: var(--text-2xl); font-weight: 700; letter-spacing: -.02em; word-break: break-word; }
.stat-label { font-size: var(--text-sm); color: var(--text-secondary); margin-top: var(--sp-4); }

/* ===== LIST ===== */
.list-section { border-radius: var(--radius-lg); overflow: hidden; width: 100%; }
.list-item { display: flex; align-items: center; gap: var(--sp-12); padding: var(--sp-12) var(--sp-16); cursor: pointer; transition: background var(--duration-fast); }
.list-item:not(:last-child) { border-bottom: 1px solid var(--separator); }
.list-item:active { background: var(--fill-tertiary); }
.list-item-icon { width: 40px; height: 40px; border-radius: var(--radius-sm); display: flex; align-items: center; justify-content: center; font-size: 20px; background: var(--fill-secondary); flex-shrink: 0; }
.list-item-content { flex: 1; min-width: 0; overflow: hidden; }
.list-item-title { font-size: var(--text-md); font-weight: 500; line-height: 1.3; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.list-item-subtitle { font-size: var(--text-sm); color: var(--text-tertiary); margin-top: var(--sp-2); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.list-item-chevron { font-size: 18px; color: var(--text-tertiary); flex-shrink: 0; }
.list-item-accessory { display: flex; align-items: center; gap: var(--sp-8); flex-shrink: 0; }

/* ===== SECTION ===== */
.section { margin-bottom: var(--sp-24); overflow: hidden; }
.section-title { font-size: var(--text-lg); font-weight: 600; margin-bottom: var(--sp-12); padding-left: var(--sp-4); }

/* ===== BADGE ===== */
.badge { display: inline-flex; align-items: center; height: 24px; padding: 0 var(--sp-12); font-size: var(--text-xs); font-weight: 600; border-radius: var(--radius-full); background: var(--fill-secondary); color: var(--text-secondary); white-space: nowrap; }
.badge-blue { background: rgba(0,122,255,.15); color: var(--blue); }
.badge-green { background: rgba(48,209,88,.15); color: var(--green); }
.badge-orange { background: rgba(255,159,10,.15); color: var(--orange); }
.badge-red { background: rgba(255,69,58,.15); color: var(--red); }
.badge-purple { background: rgba(191,90,242,.15); color: var(--purple); }

/* ===== FILTER TABS ===== */
.filter-tabs { display: flex; gap: var(--sp-4); padding: var(--sp-4); background: var(--glass-bg-thin); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border-radius: var(--radius-md); overflow-x: auto; -webkit-overflow-scrolling: touch; margin-bottom: var(--sp-16); border: 1px solid var(--glass-border-subtle); width: 100%; }
.filter-tabs::-webkit-scrollbar { display: none; }
.filter-tab { height: 36px; padding: 0 var(--sp-12); font-size: var(--text-sm); font-weight: 500; font-family: var(--font); color: var(--text-secondary); background: transparent; border: none; border-radius: var(--radius-sm); cursor: pointer; white-space: nowrap; transition: all var(--duration-fast) var(--ease-liquid); flex-shrink: 0; }
.filter-tab:active { transform: scale(.96); }
.filter-tab.active { background: var(--glass-bg-thick); color: var(--text-primary); box-shadow: 0 2px 8px var(--glass-shadow); }

/* ===== MODAL ===== */
.modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,.5); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); display: flex; align-items: flex-end; justify-content: center; z-index: 2000; padding: var(--sp-8); animation: fadeIn var(--duration-normal) var(--ease-liquid); overflow: hidden; }
@media (min-width: 768px) { .modal-overlay { align-items: center; padding: var(--sp-24); } }

.modal { width: 100%; max-width: 100%; max-height: 92vh; border-radius: var(--radius-xl) var(--radius-xl) 0 0; overflow: hidden; display: flex; flex-direction: column; box-shadow: 0 -8px 40px var(--glass-shadow); animation: slideUp var(--duration-slow) var(--ease-bounce); }
@media (min-width: 768px) { .modal { max-width: 480px; border-radius: var(--radius-xl); animation: scaleIn var(--duration-normal) var(--ease-liquid); } }

.modal-handle { width: 36px; height: 5px; background: var(--fill-primary); border-radius: var(--radius-full); margin: var(--sp-8) auto; flex-shrink: 0; }
@media (min-width: 768px) { .modal-handle { display: none; } }

.modal-header { display: flex; align-items: center; justify-content: space-between; padding: var(--sp-16) var(--sp-20); border-bottom: 1px solid var(--separator); flex-shrink: 0; }
.modal-title { font-size: var(--text-lg); font-weight: 600; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.modal-close { width: 32px; height: 32px; border-radius: var(--radius-full); background: var(--fill-secondary); border: none; font-size: 18px; color: var(--text-secondary); cursor: pointer; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
.modal-close:active { background: var(--fill-primary); }
.modal-body { padding: var(--sp-20); overflow-y: auto; overflow-x: hidden; flex: 1; overscroll-behavior: contain; }
.modal-footer { padding: var(--sp-16) var(--sp-20); padding-bottom: calc(var(--sp-16) + var(--safe-bottom)); border-top: 1px solid var(--separator); display: flex; gap: var(--sp-12); flex-shrink: 0; flex-wrap: wrap; }
.modal-footer .btn { flex: 1; min-width: 100px; }

.confirm-modal { border-radius: var(--radius-xl); padding: var(--sp-24); text-align: center; max-width: 300px; width: 100%; box-shadow: 0 16px 48px var(--glass-shadow); animation: scaleIn var(--duration-normal) var(--ease-bounce); }
.confirm-icon { font-size: 52px; margin-bottom: var(--sp-16); }
.confirm-title { font-size: var(--text-lg); font-weight: 600; margin-bottom: var(--sp-8); }
.confirm-message { font-size: var(--text-base); color: var(--text-secondary); margin-bottom: var(--sp-24); line-height: 1.5; }
.confirm-actions { display: flex; flex-direction: column; gap: var(--sp-8); }

/* ===== LOADING ===== */
.spinner { width: 32px; height: 32px; border: 3px solid var(--fill-secondary); border-top-color: var(--blue); border-radius: var(--radius-full); animation: spin .8s linear infinite; flex-shrink: 0; }
.loading-spinner { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 50vh; gap: var(--sp-16); }
.loading-text { font-size: var(--text-base); color: var(--text-secondary); }

/* Skeleton */
.skeleton { background: linear-gradient(90deg, var(--fill-tertiary) 0%, var(--fill-secondary) 50%, var(--fill-tertiary) 100%); background-size: 200% 100%; animation: skeleton 1.5s ease-in-out infinite; border-radius: var(--radius-sm); }
.skeleton-card { background: var(--glass-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border-radius: var(--radius-lg); border: 1px solid var(--glass-border); padding: var(--sp-16); }
.skeleton-avatar { width: 48px; height: 48px; border-radius: var(--radius-full); }
.skeleton-text { height: 16px; margin-bottom: var(--sp-8); }

/* ===== EMPTY STATE ===== */
.empty-state { text-align: center; padding: var(--sp-48) var(--sp-24); }
.empty-state-icon { width: 88px; height: 88px; margin: 0 auto var(--sp-16); background: var(--glass-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border-radius: var(--radius-full); border: 1px solid var(--glass-border); display: flex; align-items: center; justify-content: center; font-size: 44px; }
.empty-state-title { font-size: var(--text-xl); font-weight: 600; margin-bottom: var(--sp-8); }
.empty-state-text { font-size: var(--text-md); color: var(--text-secondary); margin-bottom: var(--sp-24); max-width: 280px; margin-left: auto; margin-right: auto; line-height: 1.5; }
.empty-state .btn { margin-top: var(--sp-8); }

/* ===== NOTIFICATIONS ===== */
.notification-container { position: fixed; top: calc(var(--safe-top) + var(--sp-16)); left: var(--sp-16); right: var(--sp-16); z-index: 3000; display: flex; flex-direction: column; gap: var(--sp-8); pointer-events: none; }
@media (min-width: 768px) { .notification-container { left: 50%; right: auto; transform: translateX(-50%); width: 400px; max-width: calc(100vw - 32px); } }

.notification { border-radius: var(--radius-lg); padding: var(--sp-12) var(--sp-16); display: flex; align-items: center; gap: var(--sp-12); animation: toastIn var(--duration-slow) var(--ease-bounce); cursor: pointer; pointer-events: auto; }
.notification-icon { width: 36px; height: 36px; border-radius: var(--radius-full); display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: 600; flex-shrink: 0; }
.notification-success .notification-icon { background: rgba(48,209,88,.15); color: var(--green); }
.notification-error .notification-icon { background: rgba(255,69,58,.15); color: var(--red); }
.notification-info .notification-icon { background: rgba(0,122,255,.15); color: var(--blue); }
.notification-content { flex: 1; min-width: 0; overflow: hidden; }
.notification-title { font-size: var(--text-base); font-weight: 600; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.notification-message { font-size: var(--text-sm); color: var(--text-secondary); margin-top: var(--sp-2); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

/* ===== TOGGLE ===== */
.toggle { width: 51px; height: 31px; border-radius: 15.5px; background: var(--fill-primary); border: none; padding: 2px; cursor: pointer; transition: background var(--duration-normal) var(--ease-liquid); position: relative; flex-shrink: 0; }
.toggle-on { background: var(--green); }
.toggle-thumb { width: 27px; height: 27px; border-radius: 50%; background: #fff; box-shadow: 0 2px 6px rgba(0,0,0,.2); display: block; transition: transform var(--duration-normal) var(--ease-bounce); }
.toggle-on .toggle-thumb { transform: translateX(20px); }
.toggle-disabled { opacity: .5; pointer-events: none; }

/* ===== LOGIN ===== */
.login-page { min-height: 100dvh; display: flex; align-items: center; justify-content: center; padding: var(--sp-24); background: linear-gradient(145deg, #667eea 0%, #764ba2 50%, #f093fb 100%); background-size: 400% 400%; animation: gradientShift 15s ease infinite; overflow-x: hidden; }
.login-card { width: 100%; max-width: 400px; background: var(--glass-bg-thick); backdrop-filter: blur(60px) saturate(200%); -webkit-backdrop-filter: blur(60px) saturate(200%); border-radius: var(--radius-xl); border: 1px solid var(--glass-border); padding: var(--sp-32); box-shadow: 0 24px 64px rgba(0,0,0,.2); animation: scaleIn var(--duration-slow) var(--ease-bounce); }
.login-header { text-align: center; margin-bottom: var(--sp-32); }
.login-logo { width: 80px; height: 80px; margin: 0 auto var(--sp-16); background: var(--gradient-blue); border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center; font-size: 40px; box-shadow: var(--shadow-blue); }
.login-title { font-size: var(--text-2xl); font-weight: 700; }
.login-subtitle { font-size: var(--text-base); color: var(--text-secondary); margin-top: var(--sp-4); }
.login-form { display: flex; flex-direction: column; gap: var(--sp-16); }
.login-error { background: rgba(255,69,58,.1); color: var(--red); padding: var(--sp-12) var(--sp-16); border-radius: var(--radius-md); font-size: var(--text-base); text-align: center; margin-bottom: var(--sp-8); border: 1px solid rgba(255,69,58,.2); }
.login-demo { margin-top: var(--sp-24); text-align: center; }
.login-demo p { font-size: var(--text-sm); color: var(--text-tertiary); margin-bottom: var(--sp-12); }
.demo-accounts { display: flex; gap: var(--sp-8); }
.demo-btn { flex: 1; height: 44px; background: var(--glass-bg-thin); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid var(--glass-border-subtle); border-radius: var(--radius-md); font-size: var(--text-sm); font-family: var(--font); color: var(--text-secondary); cursor: pointer; transition: all var(--duration-fast) var(--ease-liquid); }
.demo-btn:active { background: var(--fill-secondary); transform: scale(.96); }
.login-switch { margin-top: var(--sp-24); text-align: center; font-size: var(--text-sm); color: var(--text-secondary); }
.login-switch-btn { background: none; border: none; color: var(--blue); font-size: var(--text-sm); font-weight: 600; cursor: pointer; margin-left: var(--sp-4); font-family: var(--font); }
.login-switch-btn:hover { text-decoration: underline; }

/* ===== PROFILE ===== */
.profile-header { display: flex; flex-direction: column; align-items: center; text-align: center; padding: var(--sp-32) var(--sp-16); }
.profile-avatar { width: 96px; height: 96px; border-radius: var(--radius-full); background: var(--gradient-blue); display: flex; align-items: center; justify-content: center; font-size: 40px; font-weight: 600; color: #fff; margin-bottom: var(--sp-16); box-shadow: var(--shadow-blue); flex-shrink: 0; position: relative; overflow: hidden; }
.profile-avatar.clickable { cursor: pointer; }
.profile-avatar.clickable:hover .profile-avatar-edit { opacity: 1; }
.profile-avatar-img, .user-avatar-img, .avatar-preview-img { width: 100%; height: 100%; object-fit: cover; }
.profile-avatar-edit { position: absolute; inset: 0; background: rgba(0,0,0,.5); display: flex; align-items: center; justify-content: center; font-size: 24px; opacity: 0; transition: opacity var(--duration-fast); }
.profile-name { font-size: var(--text-xl); font-weight: 600; word-break: break-word; }
.profile-email { font-size: var(--text-base); color: var(--text-secondary); margin-top: var(--sp-4); margin-bottom: var(--sp-12); word-break: break-all; }
.profile-info { flex: 1; }
.profile-actions { margin-top: var(--sp-32); }
.profile-version { text-align: center; margin-top: var(--sp-24); font-size: var(--text-sm); color: var(--text-tertiary); }
.avatar-preview { width: 120px; height: 120px; border-radius: var(--radius-full); margin: 0 auto var(--sp-24); overflow: hidden; background: var(--gradient-blue); display: flex; align-items: center; justify-content: center; }
.avatar-preview-placeholder { font-size: 48px; font-weight: 600; color: #fff; }
.theme-selector { display: flex; gap: var(--sp-4); }
.theme-btn { width: 36px; height: 36px; border-radius: var(--radius-full); border: 2px solid var(--glass-border); background: var(--fill-tertiary); font-size: 16px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all var(--duration-fast) var(--ease-liquid); }
.theme-btn:hover { background: var(--fill-secondary); }
.theme-btn.active { border-color: var(--blue); background: rgba(0,122,255,.15); }
.user-edit-info { margin-top: var(--sp-16); padding: var(--sp-12); background: var(--fill-tertiary); border-radius: var(--radius-md); font-size: var(--text-sm); color: var(--text-secondary); }
.user-edit-info p { margin-bottom: var(--sp-4); }
.user-edit-info p:last-child { margin-bottom: 0; }

/* ===== SCHEDULE ===== */
.schedule-selectors { display: flex; flex-direction: column; gap: var(--sp-8); margin-bottom: var(--sp-16); }
@media (min-width: 768px) { .schedule-selectors { flex-direction: row; gap: var(--sp-12); } .schedule-selectors .form-select { flex: 1; max-width: 300px; } }

.selector-row { display: flex; gap: var(--sp-8); align-items: center; }
.selector-row .form-select { flex: 1; }
.selector-add-btn { width: 48px; height: 48px; border-radius: var(--radius-md); background: var(--fill-secondary); border: none; font-size: 20px; cursor: pointer; flex-shrink: 0; display: flex; align-items: center; justify-content: center; transition: all var(--duration-fast) var(--ease-liquid); }
.selector-add-btn:hover { background: var(--fill-primary); }
.schedule-group-info { text-align: center; margin-bottom: var(--sp-16); padding: var(--sp-12); background: var(--glass-bg); border-radius: var(--radius-md); border: 1px solid var(--glass-border-subtle); }
.schedule-group-badge { display: flex; align-items: center; justify-content: center; gap: var(--sp-8); flex-wrap: wrap; }
.schedule-group-name { font-size: var(--text-lg); font-weight: 600; }
.schedule-group-path { font-size: var(--text-sm); color: var(--text-tertiary); margin-top: var(--sp-4); }
.schedule-day-title { font-size: var(--text-md); font-weight: 600; text-align: center; margin-bottom: var(--sp-16); color: var(--text-secondary); }
.schedule-list { display: flex; flex-direction: column; gap: var(--sp-8); }
.schedule-item { display: flex; gap: var(--sp-12); padding: var(--sp-12) var(--sp-16); background: var(--glass-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border-radius: var(--radius-md); border: 1px solid var(--glass-border-subtle); cursor: pointer; transition: all var(--duration-fast) var(--ease-liquid); overflow: hidden; }
.schedule-item:active { background: var(--fill-tertiary); transform: scale(.98); }
.schedule-time { display: flex; flex-direction: column; align-items: flex-end; min-width: 52px; flex-shrink: 0; }
.schedule-time-start { font-size: var(--text-base); font-weight: 600; }
.schedule-time-end { font-size: var(--text-xs); color: var(--text-tertiary); }
.schedule-content { flex: 1; border-left: 3px solid var(--blue); padding-left: var(--sp-12); min-width: 0; overflow: hidden; }
.schedule-subject { font-size: var(--text-md); font-weight: 500; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.schedule-details { font-size: var(--text-sm); color: var(--text-tertiary); display: flex; flex-wrap: wrap; gap: var(--sp-8); margin-top: var(--sp-4); }
.schedule-type-badge { background: var(--fill-secondary); padding: var(--sp-2) var(--sp-8); border-radius: var(--radius-full); font-size: var(--text-xs); white-space: nowrap; }
.schedule-delete { background: none; border: none; font-size: 16px; color: var(--red); cursor: pointer; padding: var(--sp-4); flex-shrink: 0; }
.schedule-notes { font-size: var(--text-sm); color: var(--text-secondary); margin-top: var(--sp-6); padding: var(--sp-8); background: var(--fill-tertiary); border-radius: var(--radius-sm); }

/* ===== USERS ===== */
.users-list { display: flex; flex-direction: column; gap: var(--sp-8); }
.user-item { display: flex; align-items: center; gap: var(--sp-12); padding: var(--sp-12) var(--sp-16); background: var(--glass-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border-radius: var(--radius-md); border: 1px solid var(--glass-border-subtle); cursor: pointer; transition: all var(--duration-fast) var(--ease-liquid); overflow: hidden; }
.user-item:active { background: var(--fill-tertiary); transform: scale(.98); }
.user-avatar-large { width: 52px; height: 52px; border-radius: var(--radius-full); background: var(--gradient-blue); display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: 600; color: #fff; flex-shrink: 0; box-shadow: 0 4px 12px rgba(0,122,255,.25); overflow: hidden; }
.user-details { flex: 1; min-width: 0; overflow: hidden; }
.user-name-row { display: flex; align-items: center; gap: var(--sp-8); flex-wrap: wrap; }
.user-full-name { font-size: var(--text-md); font-weight: 500; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.user-email, .user-group { font-size: var(--text-sm); color: var(--text-tertiary); margin-top: var(--sp-2); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.user-delete-btn { background: none; border: none; font-size: 18px; cursor: pointer; padding: var(--sp-8); flex-shrink: 0; }

/* ===== INFO BANNER ===== */
.info-banner { display: flex; align-items: center; gap: var(--sp-12); padding: var(--sp-16); background: rgba(0,122,255,.08); border-radius: var(--radius-md); margin-bottom: var(--sp-24); border: 1px solid rgba(0,122,255,.15); overflow: hidden; }
.info-banner-icon { font-size: 28px; flex-shrink: 0; }
.info-banner-content { flex: 1; min-width: 0; overflow: hidden; }
.info-banner-title { font-size: var(--text-md); font-weight: 600; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.info-banner-subtitle { font-size: var(--text-sm); color: var(--text-secondary); margin-top: var(--sp-2); }

/* ===== ICON PICKER ===== */
.icon-picker { display: flex; flex-wrap: wrap; gap: var(--sp-8); }
.icon-option { width: 48px; height: 48px; border-radius: var(--radius-md); background: var(--fill-tertiary); border: 2px solid transparent; font-size: 24px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all var(--duration-fast) var(--ease-liquid); flex-shrink: 0; }
.icon-option:hover { background: var(--fill-secondary); }
.icon-option.active { border-color: var(--blue); background: rgba(0,122,255,.1); }

/* ===== GRID ===== */
.grid-2 { display: grid; grid-template-columns: 1fr; gap: var(--sp-24); }
@media (min-width: 768px) { .grid-2 { grid-template-columns: repeat(2, 1fr); } }

/* ===== OFFLINE BANNER ===== */
.offline-banner { position: fixed; top: calc(var(--safe-top) + var(--sp-8)); left: var(--sp-16); right: var(--sp-16); padding: var(--sp-12) var(--sp-16); background: linear-gradient(145deg, var(--orange), #f77f00); color: #fff; border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; gap: var(--sp-8); font-size: var(--text-base); font-weight: 500; z-index: 2000; box-shadow: 0 4px 16px rgba(255,159,10,.35); animation: slideDown var(--duration-slow) var(--ease-bounce); }

/* ===== GROUP NOTIFICATIONS ===== */
.notifications-list { display: flex; flex-direction: column; gap: var(--sp-12); }
.notification-card { background: var(--glass-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border-radius: var(--radius-md); border: 1px solid var(--glass-border-subtle); padding: var(--sp-16); cursor: pointer; transition: all var(--duration-fast) var(--ease-liquid); }
.notification-card:active { background: var(--fill-tertiary); }
.notification-card.important { border-left: 4px solid var(--red); background: rgba(255,69,58,.05); }
.notification-card-header { display: flex; justify-content: space-between; align-items: flex-start; gap: var(--sp-8); margin-bottom: var(--sp-8); }
.notification-card-title { font-weight: 600; font-size: var(--text-md); flex: 1; }
.notification-card-date { font-size: var(--text-sm); color: var(--text-tertiary); flex-shrink: 0; }
.notification-card-message { font-size: var(--text-base); color: var(--text-secondary); line-height: 1.5; }
.notification-card-sender { font-size: var(--text-sm); color: var(--text-tertiary); margin-top: var(--sp-8); }

/* ===== IOS SEARCH BAR ===== */
.ios-search-container { position: sticky; top: calc(var(--safe-top) + var(--sp-16)); z-index: 100; padding: 0 var(--sp-16) var(--sp-16); margin: calc(-1 * var(--sp-16)) calc(-1 * var(--sp-16)) var(--sp-20); contain: layout style paint; }
.ios-search-container-inline { margin-bottom: var(--sp-16); }

.ios-search-bar { display: flex; align-items: center; gap: var(--sp-12); height: 52px; padding: 0 var(--sp-20); background: var(--glass-medium); backdrop-filter: blur(60px) saturate(180%); -webkit-backdrop-filter: blur(60px) saturate(180%); border-radius: var(--radius-2xl); border: 1px solid var(--glass-border); box-shadow: 0 8px 32px var(--glass-shadow), inset 0 1px 0 rgba(255,255,255,.5), inset 0 -1px 0 rgba(0,0,0,.05); transition: all .3s var(--spring-easing); will-change: transform, box-shadow; }
.ios-search-bar:focus-within { transform: translateY(-2px) scale(1.01); box-shadow: 0 12px 48px var(--glass-shadow), 0 0 0 4px rgba(0,122,255,.1), inset 0 1px 0 rgba(255,255,255,.6); }
.ios-search-input { flex: 1; border: none; background: transparent; font-size: var(--text-md); font-weight: 500; color: var(--text-primary); outline: none; min-width: 0; }
.ios-search-input::placeholder { color: var(--text-tertiary); font-weight: 400; }
.ios-search-clear { width: 24px; height: 24px; border-radius: var(--radius-full); border: none; background: var(--fill-secondary); color: var(--text-tertiary); font-size: 14px; cursor: pointer; transition: all .2s var(--ease-liquid); flex-shrink: 0; display: flex; align-items: center; justify-content: center; }
.ios-search-clear:hover { background: var(--fill-primary); transform: scale(1.1); }
.ios-search-clear:active { transform: scale(.9); }

.ios-search-container-inline .ios-search-bar { height: 48px; padding: 0 var(--sp-16); border-radius: var(--radius-lg); }

/* ===== IOS STRUCTURE TREE ===== */
.ios-structure-page { padding-top: 0; contain: layout style paint; }
.ios-structure-tree { display: flex; flex-direction: column; gap: var(--sp-16); contain: layout style; }

/* Faculty Card */
.ios-faculty-card { position: relative; background: var(--glass-medium); border-radius: var(--radius-2xl); overflow: hidden; box-shadow: 0 12px 48px var(--glass-shadow), inset 0 2px 0 rgba(255,255,255,.4), inset 0 -1px 0 rgba(0,0,0,.05); transition: all .4s var(--spring-easing); will-change: transform, box-shadow; contain: layout style paint; }
.ios-faculty-card:hover { transform: translateY(-4px) scale(1.005); box-shadow: 0 20px 64px var(--glass-shadow), 0 0 0 1px rgba(0,122,255,.1), inset 0 2px 0 rgba(255,255,255,.5); }

/* Card Header */
.ios-card-header { display: flex; align-items: center; gap: var(--sp-16); padding: var(--sp-20); cursor: pointer; transition: background .2s var(--ease-liquid); position: relative; contain: layout style paint; user-select: none; -webkit-tap-highlight-color: transparent; }
.ios-card-header::after { content: ''; position: absolute; inset: 0; background: var(--fill-tertiary); opacity: 0; transition: opacity .15s var(--ease-liquid); pointer-events: none; }
.ios-card-header:active::after { opacity: 1; }
.ios-card-header.nested { padding: var(--sp-16); background: var(--glass-ultra-thin); }
.ios-card-header.nested-2 { padding: var(--sp-12); background: var(--glass-thin); }
.ios-card-header.leaf { padding: var(--sp-12); background: transparent; cursor: default; }
.ios-card-header.leaf::after { display: none; }

/* Icon Circles */
.ios-icon-circle { position: relative; display: flex; align-items: center; justify-content: center; border-radius: var(--radius-full); flex-shrink: 0; box-shadow: 0 4px 16px rgba(0,0,0,.15), inset 0 1px 0 rgba(255,255,255,.4); transition: all .3s var(--spring-easing); will-change: transform; contain: layout style paint; }
.blue-gradient { width: 60px; height: 60px; background: var(--gradient-blue); }
.purple-gradient { width: 48px; height: 48px; background: var(--gradient-purple); }
.green-gradient { width: 40px; height: 40px; background: var(--gradient-green); }
.orange-gradient { width: 32px; height: 32px; background: var(--gradient-orange); }
.ios-card-header:hover .ios-icon-circle { transform: scale(1.05) rotate(5deg); }
.ios-card-header:active .ios-icon-circle { transform: scale(.95); }

/* Card Content */
.ios-card-content { flex: 1; min-width: 0; contain: layout style; }
.ios-card-title-row { display: flex; align-items: center; gap: var(--sp-8); flex-wrap: wrap; margin-bottom: var(--sp-6); }
.ios-card-title { font-size: var(--text-xl); font-weight: 700; letter-spacing: -.02em; line-height: 1.2; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; flex-shrink: 1; min-width: 0; }
.ios-card-title.small { font-size: var(--text-lg); font-weight: 600; }
.ios-card-title.tiny { font-size: var(--text-md); font-weight: 600; }
.ios-card-title.micro { font-size: var(--text-base); font-weight: 500; }

/* iOS Badges */
.ios-badge { display: inline-flex; align-items: center; height: 24px; padding: 0 var(--sp-10); font-size: var(--text-xs); font-weight: 600; letter-spacing: .02em; border-radius: var(--radius-full); white-space: nowrap; flex-shrink: 0; transition: all .2s var(--ease-liquid); }
.ios-badge.blue { background: rgba(0,122,255,.15); color: var(--blue); box-shadow: 0 0 0 .5px rgba(0,122,255,.2); }
.ios-badge.purple { background: rgba(88,86,214,.15); color: var(--indigo); box-shadow: 0 0 0 .5px rgba(88,86,214,.2); }
.ios-badge.green { background: rgba(48,209,88,.15); color: var(--green); box-shadow: 0 0 0 .5px rgba(48,209,88,.2); }
.ios-badge.orange { background: rgba(255,159,10,.15); color: var(--orange); box-shadow: 0 0 0 .5px rgba(255,159,10,.2); }
.ios-badge.outline { background: var(--fill-tertiary); color: var(--text-secondary); box-shadow: 0 0 0 .5px var(--separator); }
.ios-badges-row { display: flex; gap: var(--sp-6); flex-wrap: wrap; }

/* Card Stats */
.ios-card-stats { display: flex; align-items: center; gap: var(--sp-8); flex-wrap: wrap; font-size: var(--text-sm); color: var(--text-tertiary); }
.ios-card-stats.small { font-size: var(--text-xs); }
.ios-card-stats.tiny { font-size: 11px; }
.ios-stat-item { display: flex; align-items: center; gap: var(--sp-4); white-space: nowrap; }
.ios-stat-separator { opacity: .5; }
.ios-card-description { margin-top: var(--sp-8); font-size: var(--text-base); line-height: 1.5; color: var(--text-secondary); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

/* Action Buttons */
.ios-card-actions { display: flex; align-items: center; gap: var(--sp-6); flex-shrink: 0; contain: layout style; }
.ios-card-actions.compact { gap: var(--sp-4); }
.ios-action-btn { width: 40px; height: 40px; border-radius: var(--radius-full); border: .5px solid var(--glass-border); background: var(--glass-thin); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); display: flex; align-items: center; justify-content: center; cursor: pointer; color: var(--text-secondary); transition: all .2s var(--spring-easing); will-change: transform; flex-shrink: 0; }
.ios-action-btn.small { width: 36px; height: 36px; }
.ios-action-btn.tiny { width: 32px; height: 32px; }
.ios-action-btn.micro { width: 28px; height: 28px; }
.ios-action-btn:hover { transform: scale(1.1); }
.ios-action-btn:active { transform: scale(.9); }
.ios-action-btn.edit { color: var(--blue); }
.ios-action-btn.edit:hover { background: rgba(0,122,255,.15); border-color: rgba(0,122,255,.3); box-shadow: 0 4px 12px rgba(0,122,255,.2); }
.ios-action-btn.delete { color: var(--red); }
.ios-action-btn.delete:hover { background: rgba(255,69,58,.15); border-color: rgba(255,69,58,.3); box-shadow: 0 4px 12px rgba(255,69,58,.2); }
.ios-action-btn.schedule { color: var(--blue); }
.ios-action-btn.schedule:hover { background: rgba(0,122,255,.15); border-color: rgba(0,122,255,.3); box-shadow: 0 4px 12px rgba(0,122,255,.2); }

/* Expand Indicator */
.ios-expand-indicator { display: flex; align-items: center; justify-content: center; color: var(--text-tertiary); transition: transform .3s var(--spring-easing); flex-shrink: 0; }
.ios-expand-indicator.small, .ios-expand-indicator.tiny { transform: scale(.9); }

/* Card Children */
.ios-card-children { padding: 0 var(--sp-20) var(--sp-20); animation: expandSpring .5s var(--spring-easing); contain: layout style; }
.ios-card-children.nested { padding: 0 var(--sp-16) var(--sp-16); padding-left: var(--sp-48); }
.ios-card-children.nested-2 { padding: 0 var(--sp-12) var(--sp-12); padding-left: var(--sp-40); }

/* Nested Cards */
.ios-directions-list, .ios-groups-list, .ios-subgroups-list { display: flex; flex-direction: column; gap: var(--sp-12); contain: layout style; }
.ios-direction-card, .ios-group-card, .ios-subgroup-card { background: var(--glass-ultra-thin); backdrop-filter: blur(40px); -webkit-backdrop-filter: blur(40px); border-radius: var(--radius-lg); border: .5px solid var(--glass-border-subtle); overflow: hidden; transition: all .3s var(--spring-easing); contain: layout style paint; }
.ios-direction-card:hover, .ios-group-card:hover { background: var(--glass-thin); border-color: var(--glass-border); box-shadow: 0 4px 16px var(--glass-shadow); transform: translateX(2px); }
.ios-subgroup-card { background: transparent; border: .5px solid var(--separator); }
.ios-subgroup-card:hover { background: var(--fill-tertiary); transform: translateX(2px); }
.ios-group-card .ios-card-header.nested-2 { cursor: pointer; }
.ios-group-card .ios-card-header.nested-2:hover { background: var(--glass-thin); }

/* Add Button */
.ios-add-button { display: flex; align-items: center; justify-content: center; gap: var(--sp-10); width: 100%; height: 48px; margin-bottom: var(--sp-12); background: var(--glass-thin); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1.5px dashed var(--glass-border); border-radius: var(--radius-lg); font-size: var(--text-sm); font-weight: 600; font-family: var(--font); color: var(--blue); cursor: pointer; transition: all .25s var(--spring-easing); will-change: transform, background; }
.ios-add-button.small { height: 42px; font-size: var(--text-xs); }
.ios-add-button.tiny { height: 36px; font-size: 11px; }
.ios-add-button:hover { background: rgba(0,122,255,.08); border-color: var(--blue); border-style: solid; transform: scale(1.01); }
.ios-add-button:active { transform: scale(.98); }
.ios-add-icon { display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; border-radius: var(--radius-full); background: var(--blue); color: #fff; flex-shrink: 0; }
.ios-add-icon.small { width: 22px; height: 22px; }
.ios-add-icon.tiny { width: 20px; height: 20px; }

/* Empty State */
.ios-empty-state { padding: var(--sp-20); text-align: center; color: var(--text-tertiary); font-size: var(--text-sm); background: var(--fill-tertiary); border-radius: var(--radius-md); }
.ios-empty-state.small { padding: var(--sp-16); font-size: var(--text-xs); }
.ios-empty-state.tiny { padding: var(--sp-12); font-size: 11px; }

/* FAB */
.ios-fab { position: fixed; right: var(--sp-20); bottom: calc(var(--tab-bar-height) + var(--safe-bottom) + var(--sp-20)); width: 60px; height: 60px; border-radius: var(--radius-full); border: none; background: var(--gradient-blue); box-shadow: 0 8px 24px rgba(0,122,255,.35), 0 2px 8px rgba(0,0,0,.15), inset 0 1px 0 rgba(255,255,255,.4); display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 900; transition: all .3s var(--spring-easing); will-change: transform; }
.ios-fab:hover { transform: scale(1.1) rotate(90deg); box-shadow: 0 12px 32px rgba(0,122,255,.45), 0 4px 12px rgba(0,0,0,.2); }
.ios-fab:active { transform: scale(.95) rotate(90deg); }

@media (min-width: 1025px) { .ios-fab { display: none; } }

/* ===== ANIMATIONS ===== */
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes slideUp { from { opacity: 0; transform: translateY(100%); } to { opacity: 1; transform: translateY(0); } }
@keyframes slideDown { from { opacity: 0; transform: translateY(-100%); } to { opacity: 1; transform: translateY(0); } }
@keyframes scaleIn { from { opacity: 0; transform: scale(.9); } to { opacity: 1; transform: scale(1); } }
@keyframes spin { to { transform: rotate(360deg); } }
@keyframes skeleton { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
@keyframes toastIn { from { opacity: 0; transform: translateY(-20px) scale(.95); } to { opacity: 1; transform: translateY(0) scale(1); } }
@keyframes gradientShift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
@keyframes expandSpring { 0% { opacity: 0; transform: translateY(-12px) scale(.95); } 60% { transform: translateY(2px) scale(1.01); } 100% { opacity: 1; transform: translateY(0) scale(1); } }

/* Page content animation */
.page-content > * { animation: fadeSlideIn .3s var(--ease-liquid); }
@keyframes fadeSlideIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
  .ios-search-container { top: calc(var(--safe-top) + var(--sp-12)); padding: 0 var(--sp-12) var(--sp-12); margin: calc(-1 * var(--sp-12)) calc(-1 * var(--sp-12)) var(--sp-16); }
  .ios-search-bar { height: 48px; padding: 0 var(--sp-16); }
  .ios-structure-tree { gap: var(--sp-12); }
  .ios-faculty-card { border-radius: var(--radius-xl); }
  .ios-card-header { padding: var(--sp-16); gap: var(--sp-12); }
  .blue-gradient { width: 52px; height: 52px; }
  .purple-gradient { width: 44px; height: 44px; }
  .green-gradient { width: 36px; height: 36px; }
  .orange-gradient { width: 28px; height: 28px; }
  .ios-card-title { font-size: var(--text-lg); }
  .ios-card-children.nested { padding-left: var(--sp-32); }
  .ios-card-children.nested-2 { padding-left: var(--sp-24); }
}

@media (max-width: 480px) {
  .ios-faculty-card { border-radius: var(--radius-lg); }
  .ios-card-header { padding: var(--sp-12); gap: var(--sp-10); }
  .blue-gradient { width: 44px; height: 44px; }
  .ios-card-title { font-size: var(--text-md); }
  .ios-card-children { padding: 0 var(--sp-12) var(--sp-12); }
  .ios-card-children.nested { padding-left: var(--sp-24); }
  .ios-card-children.nested-2 { padding-left: var(--sp-16); }
  .schedule-item { padding: var(--sp-10) var(--sp-12); gap: var(--sp-8); }
  .schedule-time { min-width: 44px; }
  .schedule-subject { font-size: var(--text-base); }
  .schedule-details { font-size: var(--text-xs); gap: var(--sp-6); }
}

/* ===== PERFORMANCE ===== */
.ios-faculty-card, .ios-direction-card, .ios-group-card, .ios-subgroup-card { contain: layout style paint; }
.ios-structure-tree, .schedule-list { contain: layout style; }
.ios-faculty-card, .ios-action-btn, .ios-icon-circle, .ios-fab { transform: translate3d(0,0,0); }

@media (hover: hover) and (pointer: fine) {
  .ios-card-header:hover, .ios-action-btn:hover, .ios-add-button:hover { will-change: transform; }
}

/* ===== DARK MODE ENHANCEMENTS ===== */
@media (prefers-color-scheme: dark) {
  .ios-faculty-card { box-shadow: 0 12px 48px rgba(0,0,0,.6), inset 0 1px 0 rgba(255,255,255,.1); }
  .ios-icon-circle { box-shadow: 0 4px 16px rgba(0,0,0,.4), inset 0 1px 0 rgba(255,255,255,.2); }
  .ios-search-bar { box-shadow: 0 8px 32px rgba(0,0,0,.4), inset 0 1px 0 rgba(255,255,255,.1); }
}

/* ===== ACCESSIBILITY ===== */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after { animation-duration: .01ms !important; transition-duration: .01ms !important; }
  .ios-faculty-card:hover, .ios-action-btn:hover { transform: none; }
}

.ios-card-header:focus-visible, .ios-action-btn:focus-visible, .ios-add-button:focus-visible { outline: 2px solid var(--blue); outline-offset: 2px; }

@media print {
  .tab-bar, .sidebar, .mobile-header, .notification-container, .offline-banner, .ios-fab { display: none !important; }
  .main-content { margin: 0 !important; padding: 0 !important; }
}

@supports (padding-bottom: env(safe-area-inset-bottom)) {
  .modal-footer { padding-bottom: calc(var(--sp-16) + env(safe-area-inset-bottom)); }
}
/* ===== ÐžÐŸÐ¢Ð˜ÐœÐ˜Ð—Ð˜Ð ÐžÐ’ÐÐÐÐ«Ð• Ð¡Ð¢Ð˜Ð›Ð˜ Ð”Ð›Ð¯ Ð¡Ð¢Ð Ð£ÐšÐ¢Ð£Ð Ð« ===== */

/* Ð˜Ð·Ð¾Ð»ÑÑ†Ð¸Ñ Ð¿ÐµÑ€ÐµÑ€Ð¸ÑÐ¾Ð²ÐºÐ¸ â€” ÐºÐ°Ð¶Ð´Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ° Ð¿ÐµÑ€ÐµÑ€Ð¸ÑÐ¾Ð²Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ð¾ */
.ios-faculty-card,
.ios-direction-card,
.ios-group-card,
.ios-subgroup-card {
  contain: layout style paint;
  will-change: transform;
}

/* Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ñ‚ÑÐ¶Ñ‘Ð»Ñ‹Ð¹ backdrop-filter Ñ Ð²Ð»Ð¾Ð¶ÐµÐ½Ð½Ñ‹Ñ… ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐµÐº */
.ios-direction-card,
.ios-group-card {
  backdrop-filter: none;
  -webkit-backdrop-filter: none;
}

/* ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð°Ñ Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸Ñ Ñ€Ð°ÑÐºÑ€Ñ‹Ñ‚Ð¸Ñ */
.ios-card-children-wrapper {
  display: grid;
  grid-template-rows: 0fr;
  transition: grid-template-rows 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  overflow: hidden;
}

.ios-card-children-wrapper.expanded {
  grid-template-rows: 1fr;
}

.ios-card-children-wrapper > * {
  overflow: hidden;
}

/* Ð˜Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ Ñ€Ð°ÑÐºÑ€Ñ‹Ñ‚Ð¸Ñ Ñ GPU Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸ÐµÐ¹ */
.ios-expand-indicator {
  transition: transform 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  will-change: transform;
}

.ios-expand-indicator.expanded {
  transform: rotate(0deg);
}

/* ÐžÑ‚ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ hover ÑÑ„Ñ„ÐµÐºÑ‚Ñ‹ Ð½Ð° Ð¼Ð¾Ð±Ð¸Ð»ÐºÐ°Ñ… Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸ */
@media (hover: none) {
  .ios-faculty-card:hover,
  .ios-direction-card:hover,
  .ios-group-card:hover,
  .ios-subgroup-card:hover {
    transform: none !important;
    box-shadow: inherit !important;
  }
  
  .ios-action-btn:hover {
    transform: none !important;
    background: inherit !important;
  }
}

/* Ð£Ð¼ÐµÐ½ÑŒÑˆÐ°ÐµÐ¼ ÑÐ»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸Ð¹ Ð½Ð° ÑÐ»Ð°Ð±Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð°Ñ… */
@media (prefers-reduced-motion: reduce) {
  .ios-card-children-wrapper {
    transition: none;
  }
  
  .ios-expand-indicator {
    transition: none;
  }
  
  .ios-faculty-card,
  .ios-direction-card,
  .ios-group-card {
    transition: none;
  }
}

/* ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð´Ð»Ñ touch ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð² */
.ios-card-header {
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

/* Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸ÑŽ Ð¿Ñ€Ð¸ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾Ð¼ Ð½Ð°Ð¶Ð°Ñ‚Ð¸Ð¸ */
.ios-card-header:active::after {
  transition: none;
}

/* ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð¸ÐºÐ¾Ð½ÐºÐ¸ â€” Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ GPU */
.ios-icon-circle {
  transform: translateZ(0);
  backface-visibility: hidden;
}

/* Ð£Ð¿Ñ€Ð¾Ñ‰Ð°ÐµÐ¼ Ñ‚ÐµÐ½Ð¸ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸ */
.ios-faculty-card {
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
}

@media (prefers-color-scheme: dark) {
  .ios-faculty-card {
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  }
}

/* ÐžÑ‚Ð»Ð¾Ð¶ÐµÐ½Ð½Ñ‹Ð¹ Ñ€ÐµÐ½Ð´ÐµÑ€Ð¸Ð½Ð³ Ð´Ð»Ñ Ð½ÐµÐ²Ð¸Ð´Ð¸Ð¼Ñ‹Ñ… ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð² */
.ios-card-children-wrapper:not(.expanded) .ios-card-children {
  visibility: hidden;
  pointer-events: none;
}

.ios-card-children-wrapper.expanded .ios-card-children {
  visibility: visible;
  pointer-events: auto;
}

/* ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ ÑÐ¿Ð¸ÑÐºÐ¾Ð² */
.ios-directions-list,
.ios-groups-list,
.ios-subgroups-list {
  contain: layout style;
}

/* Ð£Ð¿Ñ€Ð¾Ñ‰Ð°ÐµÐ¼ border-radius Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Ð½Ð° Ð¼Ð¾Ð±Ð¸Ð»ÐºÐ°Ñ… */
@media (max-width: 480px) {
  .ios-icon-circle {
    border-radius: 50%;
  }
  
  .ios-faculty-card,
  .ios-direction-card,
  .ios-group-card {
    border-radius: 16px;
  }
}

/* Ð¤Ð¸ÐºÑÐ¸Ð¼ Ð´Ñ‘Ñ€Ð³Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¸ ÑÐºÑ€Ð¾Ð»Ð»Ðµ */
.ios-structure-tree {
  -webkit-overflow-scrolling: touch;
  overflow-anchor: none;
}

/* ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð´Ð»Ñ ÑÐ¿Ð¸ÑÐºÐ° Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ñ */
.schedule-list {
  contain: layout style;
}

.schedule-item {
  contain: layout style paint;
  will-change: transform;
  transform: translateZ(0);
}

/* ÐŸÐ»Ð°Ð²Ð½Ñ‹Ð¹ hover Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð½Ð° Ð´ÐµÑÐºÑ‚Ð¾Ð¿Ðµ */
@media (hover: hover) and (pointer: fine) {
  .schedule-item {
    transition: transform 0.15s ease, background 0.15s ease;
  }
  
  .schedule-item:hover {
    transform: translateX(4px);
  }
}

/* Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ transition Ð½Ð° Ð¼Ð¾Ð±Ð¸Ð»ÐºÐ°Ñ… */
@media (hover: none) {
  .schedule-item {
    transition: none;
  }
  
  .schedule-item:active {
    background: var(--fill-tertiary);
  }
}

/* ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ð¾Ð¸ÑÐºÐ° */
.ios-search-bar {
  will-change: transform, box-shadow;
  transform: translateZ(0);
}

/* Ð£Ð¼ÐµÐ½ÑŒÑˆÐ°ÐµÐ¼ blur Ð½Ð° ÑÐ»Ð°Ð±Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð°Ñ… */
@supports (backdrop-filter: blur(10px)) {
  @media (max-width: 768px) {
    .ios-search-bar {
      backdrop-filter: blur(20px) saturate(150%);
      -webkit-backdrop-filter: blur(20px) saturate(150%);
    }
    
    .ios-faculty-card {
      backdrop-filter: blur(20px) saturate(150%);
      -webkit-backdrop-filter: blur(20px) saturate(150%);
    }
  }
}

/* Ð¤Ð¸ÐºÑ Ð´Ð»Ñ Safari â€” Ð¸Ð·Ð±ÐµÐ³Ð°ÐµÐ¼ reflow */
.ios-card-content {
  min-width: 0;
  flex: 1;
}

.ios-card-title {
  text-overflow: ellipsis;
  white-space: nowrap;
  overflow: hidden;
}

/* ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ FAB ÐºÐ½Ð¾Ð¿ÐºÐ¸ */
.ios-fab {
  transform: translateZ(0);
  backface-visibility: hidden;
  will-change: transform;
}

@media (hover: none) {
  .ios-fab:hover {
    transform: none;
  }
  
  .ios-fab:active {
    transform: scale(0.95);
  }
}
